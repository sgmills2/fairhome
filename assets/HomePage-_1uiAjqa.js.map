{"version":3,"mappings":"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","names":["lazy","__vitePreload","n","MapFilters","fetchListings","data","error","supabase","item","useMapViewport","mapBounds","setMapBounds","useState","zoom","setZoom","clusterRadius","handleViewportChange","useCallback","debounce","bounds","newZoom","isInViewport","latitude","longitude","swLng","swLat","neLng","neLat","chicagoWards","wardData","findWard","wardNumber","f","getWardCenter","feature","coords","lats","c","lngs","useSearch","selectedNeighborhood","setSelectedNeighborhood","selectedAlderperson","setSelectedAlderperson","handleNeighborhoodSelect","neighborhood","onLocationSelect","found","findNeighborhood","centerLng","centerLat","getNeighborhoodCenter","handleAlderpersonSelect","_interopRequireDefault","require$$0","ViewListRounded","_createSvgIcon","_jsxRuntime","require$$2","MapRounded","KeyboardArrowUp","KeyboardArrowDown","ComponentLoader","jsx","Box","CircularProgress","HomePage","selectedListing","setSelectedListing","showMap","setShowMap","isFiltersCollapsed","setIsFiltersCollapsed","mapRef","useRef","listings","isLoading","useQuery","visibleListings","listing","handleLocationSelect","location","priceRange","setPriceRange","squareFootageRange","setSquareFootageRange","bedrooms","setBedrooms","bathrooms","setBathrooms","jsxs","MapView","SearchBar","AlderpersonSearch","Suspense","IconButton","KeyboardArrowDownIcon","KeyboardArrowUpIcon","ListingsSidebar","ViewListRoundedIcon","MapRoundedIcon"],"ignoreList":[5,6,7,8],"sources":["../../src/features/map/index.ts","../../src/services/listings.ts","../../src/features/map/hooks/useMapViewport.ts","../../src/data/chicago-wards.ts","../../src/features/search/hooks/useSearch.ts","../../../../node_modules/@mui/icons-material/ViewListRounded.js","../../../../node_modules/@mui/icons-material/MapRounded.js","../../../../node_modules/@mui/icons-material/KeyboardArrowUp.js","../../../../node_modules/@mui/icons-material/KeyboardArrowDown.js","../../src/pages/HomePage.tsx"],"sourcesContent":["import { lazy } from 'react';\n\nexport const Map = lazy(() => import('./Map'));\nexport const MapFilters = lazy(() => import('./MapFilters')); ","import { supabase } from '../lib/supabase-client';\nimport type { Listing } from '@fairhome/shared/src/types';\n\ninterface ListingRow {\n  id: string;\n  developer_id: string | null;\n  title: string;\n  description: string | null;\n  address: string;\n  latitude: number;\n  longitude: number;\n  price: number;\n  bedrooms: number;\n  bathrooms: number;\n  square_feet: number;\n  photos: string[];\n  amenities: string[];\n  created_at: string;\n  updated_at: string;\n}\n\nexport async function fetchListings(): Promise<Listing[]> {\n  try {\n    // Use the get_listings_with_coordinates function which already returns lat/lng\n    const { data, error } = await supabase\n      .rpc('get_listings_with_coordinates')\n      .throwOnError();\n    \n    if (error) {\n      console.error('Supabase error:', error);\n      throw error;\n    }\n\n    if (!data) {\n      console.log('No data returned from Supabase');\n      return [];\n    }\n\n    console.log('Raw listings data:', data);\n\n    return (data as ListingRow[]).map(item => ({\n      id: item.id,\n      developerId: item.developer_id || '',\n      title: item.title,\n      description: item.description || '',\n      address: item.address,\n      latitude: item.latitude,\n      longitude: item.longitude,\n      price: Number(item.price),\n      bedrooms: item.bedrooms,\n      bathrooms: item.bathrooms,\n      squareFeet: item.square_feet,\n      photos: item.photos || [],\n      amenities: item.amenities || [],\n      createdAt: new Date(item.created_at),\n      updatedAt: new Date(item.updated_at)\n    }));\n  } catch (error) {\n    console.error('Error fetching listings:', error);\n    throw error;\n  }\n} ","import { useState, useCallback } from 'react';\nimport debounce from 'lodash/debounce';\n\nexport function useMapViewport() {\n  const [mapBounds, setMapBounds] = useState<[[number, number], [number, number]] | null>(null);\n  const [zoom, setZoom] = useState(11);\n\n  // Calculate cluster radius based on zoom\n  const clusterRadius = zoom >= 16 ? 30 : // Very close\n                       zoom >= 14 ? 40 : // Close\n                       zoom >= 12 ? 50 : // Medium\n                       70;              // Far\n\n  // Debounced viewport change handler\n  const handleViewportChange = useCallback(\n    debounce((bounds: [[number, number], [number, number]], newZoom: number) => {\n      setMapBounds(bounds);\n      setZoom(newZoom);\n    }, 100),\n    []\n  );\n\n  // Check if a location is within the current viewport\n  const isInViewport = useCallback((latitude: number, longitude: number) => {\n    if (!mapBounds) return true;\n    const [[swLng, swLat], [neLng, neLat]] = mapBounds;\n    return (\n      longitude >= swLng &&\n      longitude <= neLng &&\n      latitude >= swLat &&\n      latitude <= neLat\n    );\n  }, [mapBounds]);\n\n  return {\n    mapBounds,\n    zoom,\n    clusterRadius,\n    handleViewportChange,\n    isInViewport\n  };\n} ","import wardData from './chicago-wards.json';\n\nexport interface WardProperties {\n  ward: string;\n  alderperson: string | null;\n  address: string | null;\n  phone: string | null;\n  website: string | null;\n}\n\nexport interface WardFeature {\n  type: \"Feature\";\n  properties: WardProperties;\n  geometry: {\n    type: \"MultiPolygon\";\n    coordinates: number[][][][];\n  };\n}\n\nexport interface ChicagoWards {\n  type: \"FeatureCollection\";\n  features: WardFeature[];\n}\n\nexport const chicagoWards = wardData as ChicagoWards;\n\n// Helper function to find a ward by number\nexport function findWard(wardNumber: string) {\n  return chicagoWards.features.find(\n    f => f.properties.ward === wardNumber\n  );\n}\n\n// Helper function to get ward center\nexport function getWardCenter(feature: WardFeature): [number, number] {\n  // For MultiPolygon, we'll use the first polygon's bounds\n  const coords = feature.geometry.coordinates[0][0];\n  const lats = coords.map(c => c[1]);\n  const lngs = coords.map(c => c[0]);\n  return [\n    (Math.min(...lngs) + Math.max(...lngs)) / 2,\n    (Math.min(...lats) + Math.max(...lats)) / 2\n  ];\n}\n\n// Helper function to get ward bounds\nexport function getWardBounds(feature: WardFeature): [[number, number], [number, number]] {\n  const coords = feature.geometry.coordinates[0][0];\n  const lats = coords.map(c => c[1]);\n  const lngs = coords.map(c => c[0]);\n  return [\n    [Math.min(...lngs), Math.min(...lats)],\n    [Math.max(...lngs), Math.max(...lats)]\n  ];\n} ","import { useState, useCallback } from 'react';\nimport { findNeighborhood, getNeighborhoodCenter } from '../../../data/chicago-neighborhoods';\nimport { findWard, getWardCenter } from '../../../data/chicago-wards';\n\ninterface SearchLocation {\n  latitude: number;\n  longitude: number;\n}\n\nexport function useSearch() {\n  const [selectedNeighborhood, setSelectedNeighborhood] = useState<string | null>(null);\n  const [selectedAlderperson, setSelectedAlderperson] = useState<string | null>(null);\n\n  const handleNeighborhoodSelect = useCallback((neighborhood: string | null, onLocationSelect: (location: SearchLocation) => void) => {\n    setSelectedNeighborhood(neighborhood);\n    \n    if (neighborhood) {\n      const found = findNeighborhood(neighborhood);\n      if (found) {\n        const [centerLng, centerLat] = getNeighborhoodCenter(found);\n        onLocationSelect({\n          latitude: centerLat,\n          longitude: centerLng\n        });\n      }\n    }\n  }, []);\n\n  const handleAlderpersonSelect = useCallback((wardNumber: string | null, onLocationSelect: (location: SearchLocation) => void) => {\n    setSelectedAlderperson(wardNumber);\n    \n    if (wardNumber) {\n      const found = findWard(wardNumber);\n      if (found) {\n        const [centerLng, centerLat] = getWardCenter(found);\n        onLocationSelect({\n          latitude: centerLat,\n          longitude: centerLng\n        });\n      }\n    }\n  }, []);\n\n  return {\n    selectedNeighborhood,\n    selectedAlderperson,\n    handleNeighborhoodSelect,\n    handleAlderpersonSelect\n  };\n} ","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M4 14h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 5h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1M4 9h2c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m5 5h11c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 5h11c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1M8 6v2c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1\"\n}), 'ViewListRounded');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"m14.65 4.98-5-1.75c-.42-.15-.88-.15-1.3-.01L4.36 4.56C3.55 4.84 3 5.6 3 6.46v11.85c0 1.41 1.41 2.37 2.72 1.86l2.93-1.14c.22-.09.47-.09.69-.01l5 1.75c.42.15.88.15 1.3.01l3.99-1.34c.81-.27 1.36-1.04 1.36-1.9V5.69c0-1.41-1.41-2.37-2.72-1.86l-2.93 1.14c-.22.08-.46.09-.69.01M15 18.89l-6-2.11V5.11l6 2.11z\"\n}), 'MapRounded');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z\"\n}), 'KeyboardArrowUp');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z\"\n}), 'KeyboardArrowDown');","import Box from '@mui/joy/Box';\nimport { useQuery } from 'react-query';\nimport { useState, useRef, Suspense } from 'react';\nimport { MapFilters } from '../features/map';\nimport { SearchBar, AlderpersonSearch } from '../features/search';\nimport { ListingsSidebar } from '../features/listings';\nimport { fetchListings } from '../services/listings';\nimport type { Listing } from '@fairhome/shared/src/types';\nimport type { MapRef } from 'react-map-gl';\nimport { useMapViewport } from '../features/map/hooks/useMapViewport';\nimport { useSearch } from '../features/search/hooks/useSearch';\nimport CircularProgress from '@mui/joy/CircularProgress';\nimport IconButton from '@mui/joy/IconButton';\nimport ViewListRoundedIcon from '@mui/icons-material/ViewListRounded';\nimport MapRoundedIcon from '@mui/icons-material/MapRounded';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport MapView from '../features/map/Map';\nimport type { SearchLocation } from '../types/search';\n\nfunction ComponentLoader() {\n  return (\n    <Box sx={{ \n      display: 'flex', \n      justifyContent: 'center', \n      alignItems: 'center', \n      height: '100%',\n      width: '100%'\n    }}>\n      <CircularProgress />\n    </Box>\n  );\n}\n\nfunction HomePage() {\n  const [selectedListing, setSelectedListing] = useState<Listing | null>(null);\n  const [showMap, setShowMap] = useState(true);\n  const [isFiltersCollapsed, setIsFiltersCollapsed] = useState(false);\n  const mapRef = useRef<MapRef>(null);\n  const { handleViewportChange, isInViewport } = useMapViewport();\n  const { selectedNeighborhood, selectedAlderperson, handleNeighborhoodSelect, handleAlderpersonSelect } = useSearch();\n\n  const { data: listings = [], isLoading } = useQuery('listings', fetchListings);\n\n  const visibleListings = listings.filter(listing => \n    isInViewport(listing.latitude, listing.longitude)\n  );\n\n  const handleLocationSelect = (location: SearchLocation) => {\n    if (mapRef.current) {\n      mapRef.current.flyTo({\n        center: [location.longitude, location.latitude],\n        zoom: 14,\n        duration: 2000\n      });\n    }\n  };\n\n  const [priceRange, setPriceRange] = useState<[number, number]>([0, 5000]);\n  const [squareFootageRange, setSquareFootageRange] = useState<[number, number]>([0, 2000]);\n  const [bedrooms, setBedrooms] = useState<number | null>(null);\n  const [bathrooms, setBathrooms] = useState<number | null>(null);\n\n  return (\n    <Box sx={{ \n      height: 'calc(100vh - 64px)', // Subtract navbar height\n      position: 'relative',\n      overflow: 'hidden'\n    }}>\n      {/* Map Layer (Bottom) */}\n      <Box sx={{ \n        position: 'absolute',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        zIndex: 0\n      }}>\n        <MapView\n          ref={mapRef}\n          listings={listings}\n          selectedListing={selectedListing}\n          onListingClick={setSelectedListing}\n          onViewportChange={handleViewportChange}\n          selectedNeighborhood={selectedNeighborhood}\n          selectedWard={selectedAlderperson}\n        />\n      </Box>\n\n      {/* UI Overlay Layer (Top) */}\n      <Box sx={{ \n        position: 'relative',\n        zIndex: 1,\n        height: '100%',\n        pointerEvents: 'none'\n      }}>\n        {/* Search and Filters Bar (Desktop Only) */}\n        <Box sx={{ \n          display: { xs: 'flex', md: 'flex' },\n          flexDirection: 'column',\n          position: 'absolute',\n          top: 0,\n          left: '50%',\n          transform: 'translateX(-50%)',\n          width: 'auto',\n          minWidth: { md: '600px', lg: '800px' },\n          maxWidth: '60vw',\n          bgcolor: 'background.surface',\n          borderRadius: '0 0 12px 12px',\n          boxShadow: 'md',\n          overflow: 'visible',\n          pointerEvents: 'auto'\n        }}>\n          <Box sx={{ \n            position: 'relative',\n            py: 2,\n            px: 2, \n            display: 'flex', \n            flexDirection: 'column', \n            gap: 2,\n            transition: 'transform 0.3s ease-in-out',\n            marginTop: isFiltersCollapsed ? '-120px' : 0\n          }}>\n            <Box sx={{ \n              display: 'flex', \n              gap: 2, \n              alignItems: 'center',\n              justifyContent: 'center'\n            }}>\n              <Box sx={{ display: 'flex', gap: 2, flex: 1, justifyContent: 'center' }}>\n                <SearchBar \n                  onLocationSelect={handleLocationSelect}\n                  onNeighborhoodSelect={(n) => handleNeighborhoodSelect(n, handleLocationSelect)}\n                  selectedNeighborhood={selectedNeighborhood}\n                />\n                <AlderpersonSearch\n                  onAlderpersonSelect={handleAlderpersonSelect}\n                  selectedAlderperson={selectedAlderperson}\n                  onLocationSelect={handleLocationSelect}\n                />\n              </Box>\n            </Box>\n            <Box sx={{ \n              maxHeight: isFiltersCollapsed ? '0px' : '500px',\n              opacity: isFiltersCollapsed ? 0 : 1,\n              transition: 'all 0.3s ease-in-out',\n              overflow: 'hidden'\n            }}>\n              <Suspense fallback={<ComponentLoader />}>\n                <MapFilters\n                  priceRange={priceRange}\n                  onPriceRangeChange={setPriceRange}\n                  squareFootageRange={squareFootageRange}\n                  onSquareFootageRangeChange={setSquareFootageRange}\n                  bedrooms={bedrooms}\n                  onBedroomsChange={setBedrooms}\n                  bathrooms={bathrooms}\n                  onBathroomsChange={setBathrooms}\n                  maxPrice={5000}\n                  maxSquareFootage={2000}\n                />\n              </Suspense>\n            </Box>\n          </Box>\n          {/* Toggle Button */}\n          <IconButton\n            onClick={() => setIsFiltersCollapsed(!isFiltersCollapsed)}\n            variant=\"soft\"\n            sx={{ \n              position: 'absolute',\n              left: '50%',\n              bottom: isFiltersCollapsed ? -20 : -40,\n              transform: 'translateX(-50%)',\n              zIndex: 1200,\n              bgcolor: 'background.surface',\n              borderRadius: '50%',\n              boxShadow: 'md',\n              transition: 'all 0.3s ease-in-out',\n              '&:hover': {\n                bgcolor: 'background.level1'\n              }\n            }}\n          >\n            {isFiltersCollapsed ? <KeyboardArrowDownIcon /> : <KeyboardArrowUpIcon />}\n          </IconButton>\n        </Box>\n\n        {/* Desktop Layout */}\n        <Box sx={{ \n          display: { xs: 'none', md: 'flex' },\n          height: '100%',\n          position: 'absolute',\n          left: 0,\n          top: 0,\n          zIndex: 10\n        }}>\n          <ListingsSidebar\n            listings={visibleListings}\n            isLoading={isLoading}\n            selectedListing={selectedListing}\n            onListingClick={setSelectedListing}\n          />\n        </Box>\n\n        {/* Mobile Layout */}\n        <Box sx={{ \n          display: { xs: 'flex', md: 'none' },\n          height: '100%'\n        }}>\n          {!showMap && (\n            <Box sx={{ \n              width: '100%',\n              height: '100%',\n              bgcolor: 'background.surface',\n              pointerEvents: 'auto'\n            }}>\n              <ListingsSidebar\n                listings={visibleListings}\n                isLoading={isLoading}\n                selectedListing={selectedListing}\n                onListingClick={setSelectedListing}\n              />\n            </Box>\n          )}\n        </Box>\n\n        {/* Mobile View Toggle */}\n        <Box sx={{ \n          display: { xs: 'flex', md: 'none' },\n          position: 'absolute',\n          bottom: 16,\n          right: 16,\n          zIndex: 2,\n          bgcolor: 'background.surface',\n          borderRadius: 'xl',\n          boxShadow: 'md',\n          pointerEvents: 'auto'\n        }}>\n          <IconButton\n            onClick={() => setShowMap(!showMap)}\n            variant=\"soft\"\n            sx={{ borderRadius: 'xl' }}\n          >\n            {showMap ? <ViewListRoundedIcon /> : <MapRoundedIcon />}\n          </IconButton>\n        </Box>\n      </Box>\n    </Box>\n  );\n}\n\nexport default HomePage; "],"file":"assets/HomePage-_1uiAjqa.js"}